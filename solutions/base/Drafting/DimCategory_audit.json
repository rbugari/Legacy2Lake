{
  "status": "REJECTED",
  "optimized_code": null,
  "critique": [
    "Idempotency violation: Uses .mode('overwrite') for Delta targets. MERGE INTO is mandatory for all dimensional loads except Bronze/raw. This is a critical architectural breach.",
    "Hardcoding detected: Table names and source queries are hardcoded in dictionaries. These must be parameterized via context or configuration, not embedded in code.",
    "Data integrity: No COALESCE or unknown member handling in lookups. While this load has no explicit lookups, the code should be robust for future extensibility.",
    "Resiliency: Logging is only present for error states. There is no row-level or batch-level logging for processed records or success/failure counts.",
    "Precise casting: The type safety loop is present and generally correct, but the DDLs are hardcoded and not dynamically sourced from the actual target schema. This risks drift if the schema changes.",
    "Medallion structure: The code structure follows the Extract, Transform, Load pattern, but the lack of parameterization and idempotent load strategy undermines architectural compliance."
  ],
  "score": 5
}